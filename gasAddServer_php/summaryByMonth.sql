Create View
`summaryByMonth` AS
(select `a`.`DYear` AS `DYear`,`a`.`DMonth` AS `DMonth`,`a`.`currentMile` AS `currentmile`,(`a`.`currentMile` - (select (case when max(`tempgroupbymonth`.`currentMile`) then max(`tempgroupbymonth`.`currentMile`) else 0 end) AS `tmp_mile` from `sqlwpblog`.`tempgroupbymonth` where (`a`.`currentMile` > `tempgroupbymonth`.`currentMile`))) AS `mile`,round(`a`.`totalGallon`,3) AS `gallon`,round(((`a`.`currentMile` - (select (case when max(`tempgroupbymonth`.`currentMile`) then max(`tempgroupbymonth`.`currentMile`) else 0 end) from `sqlwpblog`.`tempgroupbymonth` where (`a`.`currentMile` > `tempgroupbymonth`.`currentMile`))) / `a`.`totalGallon`),2) AS `mpg`,`a`.`totalMoney` AS `total`,round(((`a`.`currentMile` - (select (case when max(`tempgroupbymonth`.`currentMile`) then max(`tempgroupbymonth`.`currentMile`) else 0 end) from `sqlwpblog`.`tempgroupbymonth` where (`a`.`currentMile` > `tempgroupbymonth`.`currentMile`))) / `a`.`totalMoney`),2) AS `mpd`,round((`a`.`totalMoney` / `a`.`totalGallon`),3) AS `avgPrice` from `sqlwpblog`.`tempgroupbymonth` `a` order by `a`.`DYear` desc,`a`.`DMonth` desc)